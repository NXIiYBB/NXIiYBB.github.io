<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Polaroid Frame + Caption üì∑</title>
<style>
  :root{
    --bg:#fdf6f0;
    --primary:#ff91a4;
    --secondary:#ffd6d6;
    --text:#1f2937;
  }
  *{box-sizing:border-box;}
  body{margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:var(--bg); display:flex; flex-direction:column; min-height:100vh;}
  header{position:sticky; top:0; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.08); z-index:10; padding:12px 16px; display:flex; justify-content:space-between; align-items:center;}
  .logo{font-size:24px;} 
  .hamburger{display:none; flex-direction:column; cursor:pointer; gap:4px;}
  .hamburger div{width:28px; height:3px; background:var(--text);}
  nav{display:flex; gap:12px;}
  nav button{padding:8px 12px; border-radius:999px; border:none; cursor:pointer; background:var(--primary); color:#fff; font-size:14px;}
  main{flex:1; display:flex; flex-direction:column; align-items:center; padding:16px;}
  canvas{max-width:90vw; border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,0.12);}
  .controls{margin-top:16px; display:flex; flex-wrap:wrap; gap:8px; justify-content:center;}
  .controls input[type=text]{padding:8px 12px; border-radius:12px; border:1px solid #ddd; min-width:180px;}
  .controls input[type=file]{display:none;}
  .file-label{cursor:pointer; padding:8px 12px; background:var(--secondary); border-radius:12px;}
  .btn{padding:8px 16px; border-radius:12px; border:none; cursor:pointer; background:var(--primary); color:#fff;}
  @media(max-width:767px){
    nav{display:none; flex-direction:column; position:absolute; top:60px; right:16px; background:#fff; padding:12px; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.12);}
    nav.show{display:flex;}
    .hamburger{display:flex;}
  }
</style>
</head>
<body>
<header>
  <div class="logo">üì∑ Polaroid Maker</div>
  <div class="hamburger" id="hamburger"><div></div><div></div><div></div></div>
  <nav id="nav">
    <button id="downloadBtn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PNG</button>
    <button id="shuffleFrame">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏£‡∏≠‡∏ö</button>
  </nav>
</header>
<main>
  <canvas id="canvas" width="1080" height="1350" aria-label="Polaroid Canvas"></canvas>
  <div class="controls">
    <label class="file-label">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ
      <input type="file" id="fileInput" accept="image/*">
    </label>
    <input type="text" id="captionInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå Caption ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å ‡πÜ...">
  </div>
</main>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let img=null;
const captionInput = document.getElementById('captionInput');

const FRAME_COLORS = ['#fff8f5','#fff0f0','#fff8e1','#f0fff8','#f8f0ff'];
let frameIndex = 0;

// Hamburger menu logic
const hamburger = document.getElementById('hamburger');
const nav = document.getElementById('nav');
hamburger.onclick = ()=> nav.classList.toggle('show');

// Load image
const fileInput = document.getElementById('fileInput');
fileInput.addEventListener('change', e=>{
  const f = e.target.files[0];
  if(f){
    const reader = new FileReader();
    reader.onload = ev=>{
      const tempImg = new Image();
      tempImg.onload=()=>{ img=tempImg; drawPolaroid(); }
      tempImg.src = ev.target.result;
    }
    reader.readAsDataURL(f);
  }
});

// Draw Polaroid Frame
function drawPolaroid(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const radius = 32;
  const marginBottom = 200;
  ctx.fillStyle = FRAME_COLORS[frameIndex];
  ctx.strokeStyle = '#ff91a4';
  ctx.lineWidth=6;
  ctx.beginPath();
  ctx.moveTo(radius,0);
  ctx.lineTo(canvas.width-radius,0);
  ctx.quadraticCurveTo(canvas.width,0,canvas.width,radius);
  ctx.lineTo(canvas.width, canvas.height-marginBottom-radius);
  ctx.quadraticCurveTo(canvas.width, canvas.height-marginBottom, canvas.width-radius, canvas.height-marginBottom);
  ctx.lineTo(radius, canvas.height-marginBottom);
  ctx.quadraticCurveTo(0, canvas.height-marginBottom,0,canvas.height-marginBottom-radius);
  ctx.lineTo(0,radius);
  ctx.quadraticCurveTo(0,0,radius,0);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();

  ctx.shadowColor='rgba(0,0,0,0.12)';
  ctx.shadowBlur=24;
  ctx.fill();
  ctx.shadowBlur=0;

  if(img){
    const marginTop = 40;
    const marginSide = 40;
    const imgHeight = canvas.height - marginTop - marginBottom;
    const imgWidth = canvas.width - marginSide*2;
    ctx.drawImage(img, marginSide, marginTop, imgWidth, imgHeight);

    // Caption
    ctx.fillStyle = '#ff6f91';
    ctx.font = '36px Comic Sans MS, system-ui';
    ctx.textAlign = 'center';
    ctx.fillText(captionInput.value||'', canvas.width/2, canvas.height - marginBottom/2 - 20);

    // Date
    const date = new Date();
    const dateStr = date.toLocaleDateString('th-TH', {day:'numeric', month:'short', year:'numeric'});
    ctx.font = '24px Comic Sans MS, system-ui';
    ctx.fillStyle = '#ff91a4';
    ctx.fillText(dateStr, canvas.width/2, canvas.height - marginBottom/2 + 20);
  }
}

// Caption input live update
captionInput.addEventListener('input', drawPolaroid);

// Shuffle frame
document.getElementById('shuffleFrame').onclick=()=>{
  frameIndex=(frameIndex+1)%FRAME_COLORS.length; drawPolaroid();
}

// Download
document.getElementById('downloadBtn').onclick=()=>{
  const link=document.createElement('a');
  link.download=`polaroid-${Date.now()}.png`;
  link.href=canvas.toDataURL('image/png');
  link.click();
}

// Initial
drawPolaroid();
</script>
</body>
</html>
